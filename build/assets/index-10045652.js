var h=Object.defineProperty;var u=(s,t,e)=>t in s?h(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var r=(s,t,e)=>(u(s,typeof t!="symbol"?t+"":t,e),e);import{fx as n,fX as p,bp as w,bq as d,fY as b,fZ as g,bb as f}from"./index-fc282d72.js";const m={}.VITE_API_URL||"https://api.beefy.finance";class I{constructor(t,e){r(this,"api");r(this,"web3",null);r(this,"multicall",null);this.chain=t,this.oracleAddress=e,this.api=n.create({baseURL:`${m}/oneinch/${t.id}/`})}async get(t,e){try{return(await this.api.get(t,{headers:{Accept:"application/json"},params:e})).data}catch(a){throw n.isAxiosError(a)?new Error(p(a)):a}}async getQuote(t){return await this.get("/quote",t)}async getSwap(t){return await this.get("/swap",t)}async getWeb3(){return this.web3===null&&(this.web3=await w(this.chain)),this.web3}async getMulticall(){return this.multicall===null&&(this.multicall=new d.MultiCall(await this.getWeb3(),this.chain.multicallAddress)),this.multicall}async getPriceInNative(t){if(!this.oracleAddress)throw new Error(`No 1inch price oracle address for ${this.chain.id}`);const e=await this.getMulticall(),a=b(g,this.oracleAddress),l=t.tokenAddresses.map(i=>({address:i,price:a.methods.getRateToEth(i,!0)})),[o]=await e.all([l]);return o.reduce((i,c)=>(i[c.address]=new f(c.price||"0"),i),{})}}export{I as OneInchApi};
